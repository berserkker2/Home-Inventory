<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Home Inventory</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    img { height: 80px; margin-right: 10px; }
    .category { margin-top: 20px; }
    form { margin-top: 30px; }
  </style>
</head>
<body>
  <h1>My Home Inventory</h1>
  <div id="inventory"></div>

  <h2>Add Item</h2>
  <form id="itemForm">
    <input name="name" placeholder="Item name" required>
    <input name="quantity" type="number" placeholder="Quantity" required>
    <input name="image" placeholder="Image URL">
    <input name="category" placeholder="Category" required>
    <button>Add</button>
  </form>

  <script>
    async function loadItems() {
      const res = await fetch('/items');
      const items = await res.json();
      const grouped = {};
      items.forEach(item => {
        if (!grouped[item.category]) grouped[item.category] = [];
        grouped[item.category].push(item);
      });

      const div = document.getElementById('inventory');
      div.innerHTML = '';
      for (const [cat, items] of Object.entries(grouped)) {
        div.innerHTML += `<div class="category"><h2>${cat}</h2>${items.map(i => `
          <div>
            <strong>${i.name}</strong> (${i.quantity})<br>
            <img src="${i.image}" alt="${i.name}">
          </div>
        `).join('')}</div>`;
      }
    }

    document.getElementById('itemForm').addEventListener('submit', async e => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target).entries());
      data.quantity = parseInt(data.quantity);
      await fetch('/items', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      e.target.reset();
      loadItems();
    });

    loadItems();
  </script>
</body>
</html>
